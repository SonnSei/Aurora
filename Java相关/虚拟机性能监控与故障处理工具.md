# 主要工具（命令行）

|名称|主要作用|
|:--:|:--:|
|**jps**|JVM Process Status Tool，显示指定系统内所有的HopSpot虚拟机进程|
|**jstat**|JVM Statistics Monitoring Tool, 用于手记HotSpot虚拟机各方面的运行数据|
|**jinfo**|Configuration Info for Java，显示虚拟机配置信息|
|**jmap**|Memory Map for Java，生成虚拟机的内存转储快照（heapdump文件）|
|**jhat**|JVM Heap Dump Browser, 用于分析heapdump文件，它会建立一个HTTP/HTML服务器，让用户可以在浏览器上查看分析结果|
|**jstack**|Stack Trace for Java， 显示虚拟机的线程快照|


* * * 
## jps：虚拟机进程状况工具

**格式**
>**jps [options] [hostid]**

**输出样例**
>PS C:\Program Files\Java\jdk1.8.0_231\bin> ./jps.exe -l  
11936 sun.tools.jps.Jps  
8932 org.jetbrains.jps.cmdline.Launcher
16568

**参数详解**
|选项|作用|
|:--:|:--:|
|-q|只输出LVMID，省略主类的名称|
|-m|输出虚拟机进程启动时传给主类main（）函数的参数|
|-l|输出主类的全名，如果进程执行的是jar包，输出jar包路径|
|-v|输出虚拟机进程启动时JVM参数|

## jstat：虚拟机统计信息监视工具
可以显示本地或者远程虚拟机进程中类装载、内存、垃圾回收、JIT编译等运行数据，是运行期定位虚拟机性能问题的首选工具

**格式**
> **jstat [ option vmid [ interval [s|ms] [count] ] ]**    
 
关于其中的**vmid**，如果是本地进程，**VMID**和**LVMID**相同，如果是远程虚拟机进程，那么**VMID**的格式应该是：
**[protocol:] [//] lvmid [@hostname [:port]/servername]**

**jstat -gc 2764 250 20** ： 每**250**毫秒查询一次**2764**进程的**垃圾收集状况**，一共查询**20**次

**参数详解**
|选项|作用|
|:--:|:--:|
|-class|监视类装载、卸载数量，总空间以及类装载耗时|
|-gc|监视Java堆状况，包括Eden、两个Survivor，老年代、永久代等的容量，已用空间，GC时间合计等|
|-gccapacity|监视内容与-gc基本相同，但是主要关注Java堆各个区域使用到的最大、最小空间|
|-gcutil|监视内容与-gc基本相同，但是主要关注已用空间的占比|
|-gccause|与gcutil功能一样，但是会额外输出导致上一次GC产生的原因|
|-gcnew|监视新生代GC状况|
|-gcnewcapacity|与-gcnew基本相同，但是主要关注最大、最小空间|
|-gcold|监视老年代GC状况|
|-gcoldcapacity|与-gcold基本相同，但是主要关注最大、最小空间|
|-gcpermcapacity|输出永久代用到的最大、最小空间|
|-complier|输出JIT编译器编译过的方法、耗时等|
|-printcompilation|输出已经被JIT编译的方法|

## jinfo： Java配置信息工具
所用是实时查看和调整虚拟机各项参数

使用**jps -v**可以查看虚拟机启动时显示指定的参数列表，但是如果想知道未被显示指定的的系统默认值，除了去找资料，就是用**jinfo的-flag**选项了

**格式**
> **jinfo [option] pid**

可以使用**flag[+|-] name**或者**flag name=value**修改一部分运行期可写的虚拟机参数值


## jmap：Java内存映像工具
如果不用这个命令，还可用```-XX:+HeapDumpOnOutOfMemoryError```让虚拟机在OOM时候自动生成dump文件

**格式**
> **jmap [ optin ] vmid**

|选项|作用|
|:--:|:--:|
|-dump|生成Java堆转储快照|
|-finalizerinfo|显示在F-Queue中等待Finalizer线程执行finalize方法的对象|
|-heap|显示Java堆详细信息，如使用哪种回收器、参数配置、分代状况等|
|-histo|显示堆中对象统计信息，包括类、实例数量、合计容量|
|-permstat|以ClassLoader为统计口径显示永久代的内存状态|
|-F|当虚拟机进程堆-dump选项没有相应时，可以使用这个选项强制生成dump快照|  

## jstack：Java堆栈跟踪工具
生成虚拟机当前时刻线程快照,一般称为```threaddump```文件或者```javacore```文件
**格式**
> **jstack [ option ] vmid**

|选项|作用|
|:--:|:--:|
|-F|当正常输出请求不被相应的时候，强制输出线程堆栈|
|-l|除堆栈外，显示关于锁的附加信息|
|-m|如果调用本地方法的话，可以显示C/C++的堆栈|

# 可视化工具

## Jconsole：Java监视与管理控制台
## VisualVM：多合一故障处理工具